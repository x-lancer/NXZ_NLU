# NXZ NLU Service 部署指南 (Windows Server)

本指南将帮助你将 NXZ NLU 服务部署到腾讯云 Windows 服务器。

## 服务器信息
- **IP**: 119.91.36.69
- **用户名**: Administrator
- **密码**: aA1234567890

## 第一步：连接服务器

1. 在你的电脑上，按 `Win + R` 键，输入 `mstsc` 并回车，打开“远程桌面连接”。
2. 在“计算机”栏输入 IP 地址：`119.91.36.69`。
3. 点击“连接”，输入用户名 `Administrator` 和密码 `aA1234567890`。
4. 如果弹出证书警告，选择“是”继续连接。

## 第二步：环境准备 (在服务器上操作)

1. **安装 Python**
   - 打开服务器上的浏览器 (Edge/IE)。
   - 访问 [python.org/downloads](https://www.python.org/downloads/) 下载 Python 3.10 或 3.11 的 Windows 安装包 (installer)。
   - **重要**：运行安装程序时，务必勾选底部的 **"Add Python to PATH"** (将 Python 添加到环境变量)。
   - 点击 "Install Now" 完成安装。
   - 安装完成后，打开命令提示符 (Win+R -> cmd)，输入 `python --version` 确认安装成功。

## 第三步：传输项目文件

1. **打包项目**
   - 在你本地电脑上，将整个项目文件夹压缩为 `NXZ_NLU.zip`。
   
2. **复制到服务器**
   - 在远程桌面窗口中，你可以直接从本地电脑复制压缩包，然后在服务器桌面上粘贴。
   - 或者通过网盘下载。
   
3. **解压**
   - 在服务器上，将 `NXZ_NLU.zip` 解压到 `C:\NXZ_NLU` (或其他你喜欢的目录)。

## 第四步：安装依赖和启动服务

1. 打开解压后的项目文件夹 (`C:\NXZ_NLU`)。
2. 双击运行 `install_deps.bat` 脚本。
   - 这将自动安装所有需要的 Python 库。
   - 脚本使用了清华大学镜像源，下载速度会更快。
   - 等待安装完成，窗口会提示 "Installation Complete"。
3. 双击运行 `start_server.bat` 脚本。
   - 第一次运行时，服务会自动下载 AI 模型 (MiniLM)，可能需要几分钟。
   - 看到 `INFO: Application startup complete` 和 `Uvicorn running on http://0.0.0.0:8000` 字样时，表示服务启动成功。

## 第五步：开放端口 (非常重要)

为了让外网能够访问你的 API，你需要配置防火墙。

1. **Windows 防火墙设置 (在服务器内)**
   - 按 `Win + R`，输入 `wf.msc` 打开高级安全防火墙。
   - 点击左侧 "入站规则" -> 右侧 "新建规则"。
   - 选择 "端口" -> 下一步。
   - 选择 "TCP"，特定本地端口输入 `8000` -> 下一步。
   - 选择 "允许连接" -> 下一步 -> 下一步。
   - 名称输入 "NXZ NLU Service" -> 完成。

2. **腾讯云安全组设置 (在腾讯云网页控制台)**
   - 这一步需要在腾讯云网页后台操作，服务器内部无法修改云防火墙。
   - 登录腾讯云控制台，找到该轻量应用服务器或 CVM 实例。
   - 找到 "防火墙" 或 "安全组" 选项卡。
   - 点击 "添加规则"。
   - 协议：TCP
   - 端口：8000
   - 策略：允许
   - 来源：0.0.0.0/0 (允许所有 IP 访问) 或指定你的 IP。

## 第六步：验证

服务启动并配置好防火墙后，你可以通过以下地址访问：

- **API 文档**: `http://119.91.36.69:8000/docs`
- **API 测试界面**: `http://119.91.36.69:8000/test-ui`

## 常见问题

- **下载模型慢/失败**：`start_server.bat` 已配置使用 `hf-mirror.com` 镜像，通常应该很快。如果依然失败，请检查服务器网络。
- **端口无法访问**：请务必检查腾讯云控制台的安全组设置，这是最容易被忽略的一步。

